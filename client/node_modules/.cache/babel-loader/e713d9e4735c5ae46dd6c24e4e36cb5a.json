{"ast":null,"code":"var _jsxFileName = \"/Users/dugalleix/Alyra Dev/Ropsten/DappVot/client/src/assets/components/StatusDisplay.js\";\nimport React from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default class StatusDisplay extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.nextStep = async () => {\n      const {\n        accounts,\n        contract\n      } = this.props.state;\n\n      switch (this.props.state.currentStatus) {\n        case 0:\n          await contract.methods.proposalSessionBegin().send({\n            from: accounts[0]\n          });\n          break;\n\n        case 1:\n          await contract.methods.proposalSessionEnded().send({\n            from: accounts[0]\n          });\n          break;\n\n        case 2:\n          await contract.methods.votingSessionStarted().send({\n            from: accounts[0]\n          });\n          break;\n\n        case 3:\n          await contract.methods.votingSessionEnded().send({\n            from: accounts[0]\n          });\n          break;\n\n        case 4:\n          await contract.methods.votesTallied().send({\n            from: accounts[0]\n          });\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    this.newSession = async isWithoutVoter => {\n      const {\n        accounts,\n        contract,\n        web3\n      } = this.props.state;\n      let context = this;\n      await contract.methods.restartSession(isWithoutVoter).send({\n        from: accounts[0]\n      }, async (erreur, tx) => {\n        if (tx) {\n          await web3.eth.getTransactionReceipt(tx, async (erreur, receipt) => {\n            if (receipt.status) {\n              await context.goToNewSession();\n            }\n          });\n        }\n      });\n    };\n\n    this.goToNewSession = async () => {\n      this.props.goToNewSession();\n    };\n\n    this.adminTable = ['Enregistrement des voteurs', 'Début de l\\'enregistrement des propositions', 'Fin de l\\'enregistrement des propositions', 'Début des votes', 'Fin des votes', 'Dépouillement'];\n    this.voterTable = ['Enregistrement des autres voteurs', 'Enregistrement des propositions', 'Validation des propositions...', 'Phase des votes', 'En attente du dépouillement', 'Voici les résultats des votes de la session'];\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex align-items-center justify-content-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"btn btn-light disabled\",\n        children: this.props.userType === \"Admin\" ? this.adminTable[this.props.state.currentStatus] : this.voterTable[this.props.state.currentStatus]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this), this.props.state.currentStatus < this.adminTable.length - 1 && this.props.userType === \"Admin\" && /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"button\",\n        className: \"btn btn-primary m-3\",\n        value: \"Etape suivante\",\n        onClick: this.nextStep\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 11\n      }, this), this.props.state.currentStatus === 5 && this.props.userType === \"Admin\" && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"button\",\n          className: \"btn btn-success mr-3\",\n          value: \"Nouvelle session (avec les voteurs)\",\n          onClick: () => this.newSession(false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"button\",\n          className: \"btn btn-success\",\n          value: \"Nouvelle session (sans voteurs)\",\n          onClick: () => this.newSession(true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"names":["React","StatusDisplay","Component","constructor","props","nextStep","accounts","contract","state","currentStatus","methods","proposalSessionBegin","send","from","proposalSessionEnded","votingSessionStarted","votingSessionEnded","votesTallied","newSession","isWithoutVoter","web3","context","restartSession","erreur","tx","eth","getTransactionReceipt","receipt","status","goToNewSession","adminTable","voterTable","render","userType","length"],"sources":["/Users/dugalleix/Alyra Dev/Ropsten/DappVot/client/src/assets/components/StatusDisplay.js"],"sourcesContent":["import React from 'react';\n\nexport default class StatusDisplay extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.adminTable = [\n      'Enregistrement des voteurs',\n      'Début de l\\'enregistrement des propositions',\n      'Fin de l\\'enregistrement des propositions',\n      'Début des votes',\n      'Fin des votes',\n      'Dépouillement'\n    ];\n\n    this.voterTable = [\n      'Enregistrement des autres voteurs',\n      'Enregistrement des propositions',\n      'Validation des propositions...',\n      'Phase des votes',\n      'En attente du dépouillement',\n      'Voici les résultats des votes de la session'\n    ];\n\n  } \n\n  nextStep = async () => {\n    const { accounts, contract } = this.props.state;    \n    switch(this.props.state.currentStatus){\n      case 0 :\n        await contract.methods.proposalSessionBegin().send({ from: accounts[0] });\n        break;\n      case 1 :\n        await contract.methods.proposalSessionEnded().send({ from: accounts[0] });\n        break;\n      case 2 :   \n        await contract.methods.votingSessionStarted().send({ from: accounts[0] });\n        break;     \n      case 3 :\n        await contract.methods.votingSessionEnded().send({ from: accounts[0] });\n        break;  \n      case 4 :\n        await contract.methods.votesTallied().send({ from: accounts[0] });\n        break;  \n      default :\n        break;  \n    }\n  };\n\n  newSession = async (isWithoutVoter) => {\n    const { accounts, contract, web3 } = this.props.state;    \n    let context = this;\n\n    await contract.methods.restartSession(isWithoutVoter).send({ from: accounts[0] },\n    async (erreur, tx) => {\n      if(tx){\n        await web3.eth.getTransactionReceipt(tx, \n          async (erreur, receipt) => {\n            if(receipt.status){\n              await context.goToNewSession();\n            }\n          }\n        )\n      }\n    })\n  };\n\n  goToNewSession = async () => {\n    this.props.goToNewSession();\n  };\n\n  render(){\n    return (\n      <div className=\"d-flex align-items-center justify-content-center\">\n        \n        <button type=\"button\" className=\"btn btn-light disabled\">{       \n          (this.props.userType === \"Admin\") \n          ? this.adminTable[this.props.state.currentStatus]     \n          : this.voterTable[this.props.state.currentStatus]\n        }</button>\n\n        { ((this.props.state.currentStatus < this.adminTable.length-1) && (this.props.userType === \"Admin\")) &&\n          <input type=\"button\" className=\"btn btn-primary m-3\" value=\"Etape suivante\" onClick= { this.nextStep } /> \n        }\n\n        { ((this.props.state.currentStatus === 5) && (this.props.userType === \"Admin\")) &&\n          <div>\n            <input type=\"button\" className=\"btn btn-success mr-3\" value=\"Nouvelle session (avec les voteurs)\" onClick= { () => this.newSession(false) } /> \n            <input type=\"button\" className=\"btn btn-success\" value=\"Nouvelle session (sans voteurs)\" onClick= { () => this.newSession(true) } /> \n          </div>\n        }\n\n      </div>\n    );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}